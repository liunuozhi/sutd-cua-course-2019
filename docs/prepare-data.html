<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Prepare data | Explore Wikipedia locations</title>
  <meta name="description" content="Chapter 2 Prepare data | Explore Wikipedia locations" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Prepare data | Explore Wikipedia locations" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Prepare data | Explore Wikipedia locations" />
  
  
  

<meta name="author" content="Ronnie Liu Nuozhi" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="eda-for-text-contents.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Your project name</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Exploring Topics of Place and Housing Price</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#research-question-and-hypothesis"><i class="fa fa-check"></i><b>1.2</b> Research question and hypothesis</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#hypothesis"><i class="fa fa-check"></i><b>1.2.1</b> Hypothesis</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#research-question"><i class="fa fa-check"></i><b>1.2.2</b> Research question</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.3</b> Data sources</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#source-1-hdb-housing"><i class="fa fa-check"></i><b>1.3.1</b> Source 1: HDB housing</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#source-2-wikipedia"><i class="fa fa-check"></i><b>1.3.2</b> Source 2: Wikipedia</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#methodology"><i class="fa fa-check"></i><b>1.4</b> Methodology</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#extensionslimitations"><i class="fa fa-check"></i><b>1.5</b> Extensions/Limitations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prepare-data.html"><a href="prepare-data.html"><i class="fa fa-check"></i><b>2</b> Prepare data</a><ul>
<li class="chapter" data-level="2.1" data-path="prepare-data.html"><a href="prepare-data.html#wikipedia-data"><i class="fa fa-check"></i><b>2.1</b> Wikipedia data</a><ul>
<li class="chapter" data-level="2.1.1" data-path="prepare-data.html"><a href="prepare-data.html#change-singapore-to-hexagons"><i class="fa fa-check"></i><b>2.1.1</b> change singapore to hexagons</a></li>
<li class="chapter" data-level="2.1.2" data-path="prepare-data.html"><a href="prepare-data.html#remove-locations-outside-singapore"><i class="fa fa-check"></i><b>2.1.2</b> Remove locations outside Singapore</a></li>
<li class="chapter" data-level="2.1.3" data-path="prepare-data.html"><a href="prepare-data.html#binding-points-with-hex_id"><i class="fa fa-check"></i><b>2.1.3</b> binding points with hex_id</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="prepare-data.html"><a href="prepare-data.html#housing"><i class="fa fa-check"></i><b>2.2</b> Housing</a><ul>
<li class="chapter" data-level="2.2.1" data-path="prepare-data.html"><a href="prepare-data.html#import-housing-location"><i class="fa fa-check"></i><b>2.2.1</b> import housing location</a></li>
<li class="chapter" data-level="2.2.2" data-path="prepare-data.html"><a href="prepare-data.html#binding-housing-to-hexagon"><i class="fa fa-check"></i><b>2.2.2</b> binding housing to hexagon</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="prepare-data.html"><a href="prepare-data.html#wiki-in-conjunction-with-house"><i class="fa fa-check"></i><b>2.3</b> Wiki in conjunction with House</a></li>
<li class="chapter" data-level="2.4" data-path="prepare-data.html"><a href="prepare-data.html#export-data"><i class="fa fa-check"></i><b>2.4</b> Export data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="eda-for-text-contents.html"><a href="eda-for-text-contents.html"><i class="fa fa-check"></i><b>3</b> EDA for text contents</a><ul>
<li class="chapter" data-level="3.1" data-path="eda-for-text-contents.html"><a href="eda-for-text-contents.html#tidy-text"><i class="fa fa-check"></i><b>3.1</b> Tidy text</a><ul>
<li class="chapter" data-level="3.1.1" data-path="eda-for-text-contents.html"><a href="eda-for-text-contents.html#a-look-at-titles"><i class="fa fa-check"></i><b>3.1.1</b> A look at titles</a></li>
<li class="chapter" data-level="3.1.2" data-path="eda-for-text-contents.html"><a href="eda-for-text-contents.html#a-look-at-an-articles"><i class="fa fa-check"></i><b>3.1.2</b> A look at an articles</a></li>
<li class="chapter" data-level="3.1.3" data-path="eda-for-text-contents.html"><a href="eda-for-text-contents.html#tokenizations-lemmatization-pos-tagging"><i class="fa fa-check"></i><b>3.1.3</b> Tokenizations &amp; Lemmatization &amp; POS tagging</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="eda-for-text-contents.html"><a href="eda-for-text-contents.html#n-gram"><i class="fa fa-check"></i><b>3.2</b> N-gram</a><ul>
<li class="chapter" data-level="3.2.1" data-path="eda-for-text-contents.html"><a href="eda-for-text-contents.html#bigram"><i class="fa fa-check"></i><b>3.2.1</b> Bigram</a></li>
<li class="chapter" data-level="3.2.2" data-path="eda-for-text-contents.html"><a href="eda-for-text-contents.html#trigram"><i class="fa fa-check"></i><b>3.2.2</b> Trigram</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="topic-modeling.html"><a href="topic-modeling.html"><i class="fa fa-check"></i><b>4</b> Topic modeling</a><ul>
<li class="chapter" data-level="4.1" data-path="topic-modeling.html"><a href="topic-modeling.html#corpus"><i class="fa fa-check"></i><b>4.1</b> Corpus</a></li>
<li class="chapter" data-level="4.2" data-path="topic-modeling.html"><a href="topic-modeling.html#tf-idf"><i class="fa fa-check"></i><b>4.2</b> TF-IDF</a></li>
<li class="chapter" data-level="4.3" data-path="topic-modeling.html"><a href="topic-modeling.html#lda"><i class="fa fa-check"></i><b>4.3</b> LDA</a><ul>
<li class="chapter" data-level="4.3.1" data-path="topic-modeling.html"><a href="topic-modeling.html#composition-of-topics-theta"><i class="fa fa-check"></i><b>4.3.1</b> Composition of topics (theta)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="topic-modeling.html"><a href="topic-modeling.html#binding-topics-with-spatial-information"><i class="fa fa-check"></i><b>4.4</b> Binding topics with spatial information</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>5</b> PCA</a><ul>
<li class="chapter" data-level="5.1" data-path="pca.html"><a href="pca.html#binding-topic-with-housing"><i class="fa fa-check"></i><b>5.1</b> Binding topic with housing</a></li>
<li class="chapter" data-level="5.2" data-path="pca.html"><a href="pca.html#sample-statistic"><i class="fa fa-check"></i><b>5.2</b> Sample statistic</a><ul>
<li class="chapter" data-level="5.2.1" data-path="pca.html"><a href="pca.html#compare-mean-price-between-topics"><i class="fa fa-check"></i><b>5.2.1</b> Compare mean price between topics</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="pca.html"><a href="pca.html#pca-1"><i class="fa fa-check"></i><b>5.3</b> PCA</a></li>
<li class="chapter" data-level="5.4" data-path="pca.html"><a href="pca.html#regression"><i class="fa fa-check"></i><b>5.4</b> Regression</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="conclusion-and-limitations.html"><a href="conclusion-and-limitations.html"><i class="fa fa-check"></i><b>6</b> Conclusion and limitations</a><ul>
<li class="chapter" data-level="6.1" data-path="conclusion-and-limitations.html"><a href="conclusion-and-limitations.html#conclusion"><i class="fa fa-check"></i><b>6.1</b> Conclusion</a></li>
<li class="chapter" data-level="6.2" data-path="conclusion-and-limitations.html"><a href="conclusion-and-limitations.html#limitations"><i class="fa fa-check"></i><b>6.2</b> Limitations</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Explore Wikipedia locations</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="prepare-data" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Prepare data</h1>
<div id="wikipedia-data" class="section level2">
<h2><span class="header-section-number">2.1</span> Wikipedia data</h2>
<div id="change-singapore-to-hexagons" class="section level3">
<h3><span class="header-section-number">2.1.1</span> change singapore to hexagons</h3>
<p>The hexagon divides singapre as a unit of 1 km. Each hexagon grid will be attributed unique id as <code>hex_id</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># singapore </span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">singapore &lt;-<span class="st"> </span><span class="kw">st_read</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;project-data/singapore_outline/singapore_outline.shp&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_transform</span>(<span class="dt">crs=</span><span class="dv">4326</span>)</a></code></pre></div>
<pre><code>## Reading layer `singapore_outline&#39; from data source `/Users/yaya/Desktop/Liu/liu-nuozhi/project-data/singapore_outline/singapore_outline.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 1 feature and 1 field
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33
## proj4string:    +proj=tmerc +lat_0=1.366666666666667 +lon_0=103.8333333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +datum=WGS84 +units=m +no_defs</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># hex</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">hex &lt;-<span class="st"> </span>singapore <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_transform</span>(<span class="dt">crs =</span> <span class="dv">3414</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_make_grid</span>(<span class="dt">cellsize =</span> <span class="dv">1000</span>, <span class="dt">square =</span> F) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_transform</span>(<span class="dt">crs=</span><span class="dv">4326</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_sf</span>()</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">hex<span class="op">$</span>hex_id &lt;-<span class="st"> </span>hex <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rownames</span>() </a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="kw">qtm</span>(hex)</a></code></pre></div>
<p><img src="explore-wikipedia-location_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">cat</span>(<span class="st">&quot;The total number of hexagons: &quot;</span>, hex <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nrow</span>())</a></code></pre></div>
<pre><code>## The total number of hexagons:  1141</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">glimpse</span>(hex)</a></code></pre></div>
<pre><code>## Rows: 1,141
## Columns: 2
## $ geometry &lt;POLYGON [°]&gt; POLYGON ((103.6057 1.216125..., POLYGON ((103.6057 1…
## $ hex_id   &lt;chr&gt; &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;, &quot;11&quot;, &quot;12…</code></pre>
</div>
<div id="remove-locations-outside-singapore" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Remove locations outside Singapore</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">wiki &lt;-<span class="st"> </span><span class="kw">read_csv</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;project-data/wiki.csv&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>X1)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw">glimpse</span>(wiki)</a></code></pre></div>
<pre><code>## Rows: 1,233
## Columns: 5
## $ lat    &lt;dbl&gt; 1.232600, 1.366347, 1.334167, 1.451389, 1.376631, 1.211700, 1.…
## $ lon    &lt;dbl&gt; 103.5327, 103.5484, 103.5494, 103.5889, 103.5918, 103.6125, 10…
## $ pageid &lt;dbl&gt; 13108718, 1838457, 6170311, 5073671, 5974898, 3956978, 6110331…
## $ title  &lt;chr&gt; &quot;Masjid Al-Mawaddah&quot;, &quot;Port of Tanjung Pelepas&quot;, &quot;Pulai River&quot;…
## $ text   &lt;chr&gt; &quot;Masjid Al-Mawaddah  is a mosque located in Sengkang, at the j…</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># wiki -&gt; sf</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">wiki_sf &lt;-<span class="st"> </span>wiki <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_as_sf</span>(<span class="dt">coords=</span><span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>, <span class="st">&quot;lat&quot;</span>), <span class="dt">crs=</span><span class="dv">4326</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co"># How many points out of boundary?</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">wiki_sf_sg &lt;-<span class="st"> </span>wiki_sf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_filter</span>(hex) <span class="co"># filter wiki sf</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"></a>
<a class="sourceLine" id="cb10-7" data-line-number="7">wiki_not_in_boundary &lt;-<span class="st"> </span>wiki<span class="op">$</span>title <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">setdiff</span>(wiki_sf_sg<span class="op">$</span>title)</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">wiki_not_in_boundary <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">length</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cat</span>(<span class="st">&quot;There are &quot;</span>, ., <span class="st">&quot;points out of the boundary.&quot;</span>)</a></code></pre></div>
<pre><code>## There are  93 points out of the boundary.</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">map_sg &lt;-<span class="st"> </span><span class="kw">tm_shape</span>(hex) <span class="op">+</span><span class="st"> </span><span class="kw">tm_polygons</span>()</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">map_sg <span class="op">+</span><span class="st"> </span><span class="kw">tm_shape</span>(wiki_sf) <span class="op">+</span><span class="st"> </span><span class="kw">tm_dots</span>() <span class="op">+</span><span class="st"> </span><span class="kw">tm_layout</span>(<span class="dt">title =</span> <span class="st">&quot;Before filter&quot;</span>)</a></code></pre></div>
<p><img src="explore-wikipedia-location_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">map_sg <span class="op">+</span><span class="st"> </span><span class="kw">tm_shape</span>(wiki_sf_sg) <span class="op">+</span><span class="st"> </span><span class="kw">tm_dots</span>() <span class="op">+</span><span class="st"> </span><span class="kw">tm_layout</span>(<span class="dt">title =</span> <span class="st">&quot;After filter&quot;</span>)</a></code></pre></div>
<p><img src="explore-wikipedia-location_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<p>The dataset consists of 1233 wikipedia pages of locations. Each locations has its geocoordinate, page id, title of the page and the content of the article. From the glimpse of the data, we can see the dataset contains 5 columns: <code>lat</code>, <code>lon</code>, <code>pageid</code>, <code>title</code>, <code>text</code>. There are 1233 articles in the total datasets.</p>
<p>At very primary look at the dataset, most of locations are close to central area. There are 108 points may locate in Malaysia which drop outside of the Singapore boundary. Here filters the dataset which only includes locations within Singapore. As as result, there are 1140 locations with Wikipedia pages.</p>
</div>
<div id="binding-points-with-hex_id" class="section level3">
<h3><span class="header-section-number">2.1.3</span> binding points with hex_id</h3>
<p>In this step, each locations will be assign a hex_id by checking the point is within the hexagons.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">wiki_sf_sg &lt;-<span class="st"> </span><span class="kw">st_join</span>(wiki_sf_sg, hex)</a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">qtm</span>(hex) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">wiki_sf_sg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>(hex_id, <span class="dt">sort =</span> T) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="st">  </span><span class="kw">top_n</span>(<span class="dv">20</span>, n) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="st">  </span><span class="kw">qtm</span>() <span class="op">+</span><span class="st"> </span><span class="kw">tm_layout</span>(<span class="dt">title =</span> <span class="st">&quot;Top 20 hex&quot;</span>)</a></code></pre></div>
<p><img src="explore-wikipedia-location_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>There are 381 hexagons which have been assigned to each wikipedia locations, while there are 1140 wikipedia locations in total.The plot above shows the top 20 hexagons which contain the most number of points. From the map, we can see central area has high density of listed location on Wikipeda. Besides some few hexagons show other parts Singapore also have relative dense locations on Wikipedia such as Tampinese, Sengkang and Punngol, Ang Mo Kio, Queestown and Jurong East.</p>
<hr />
</div>
</div>
<div id="housing" class="section level2">
<h2><span class="header-section-number">2.2</span> Housing</h2>
<div id="import-housing-location" class="section level3">
<h3><span class="header-section-number">2.2.1</span> import housing location</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">house &lt;-<span class="st"> </span><span class="kw">read_rds</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;data/resale_with_geom.rds&quot;</span>))</a></code></pre></div>
</div>
<div id="binding-housing-to-hexagon" class="section level3">
<h3><span class="header-section-number">2.2.2</span> binding housing to hexagon</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">house &lt;-<span class="st"> </span><span class="kw">st_join</span>(house <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_transform</span>(<span class="dt">crs =</span> <span class="dv">4326</span>), hex)</a></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">qtm</span>(hex) <span class="op">+</span><span class="st"> </span>house <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">qtm</span>()</a></code></pre></div>
<p><img src="explore-wikipedia-location_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">house_hex &lt;-<span class="st"> </span>house <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_set_geometry</span>(<span class="ot">NULL</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(hex_id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_price =</span> <span class="kw">mean</span>(resale_price),</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">            <span class="dt">mean_area =</span> <span class="kw">mean</span>(floor_area_sqm),</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">            <span class="dt">mean_sqr_price =</span> mean_price <span class="op">/</span><span class="st"> </span>mean_area,</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">            <span class="dt">mean_lease =</span> <span class="kw">mean</span>(remaining_lease))</a>
<a class="sourceLine" id="cb19-6" data-line-number="6"></a>
<a class="sourceLine" id="cb19-7" data-line-number="7">hex <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(house_hex) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tm_shape</span>() <span class="op">+</span><span class="st"> </span><span class="kw">tm_polygons</span>(<span class="dt">col =</span> <span class="st">&quot;mean_sqr_price&quot;</span>)</a></code></pre></div>
<pre><code>## Joining, by = &quot;hex_id&quot;</code></pre>
<p><img src="explore-wikipedia-location_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>The same processing as the wikipedia page, the houses locations are aggregated by the same hexagons. Each hexagons will contain an average housing price for per meter squre. It is not surprsing to see the central area will be the most expensive.</p>
</div>
</div>
<div id="wiki-in-conjunction-with-house" class="section level2">
<h2><span class="header-section-number">2.3</span> Wiki in conjunction with House</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">house_hex &lt;-<span class="st"> </span>hex <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(house_hex) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(mean_sqr_price))</a></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co"># wiki_hex &lt;- st_filter(wiki_sf_sg, house_hex)</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">wiki_hex &lt;-<span class="st"> </span>wiki_sf_sg</a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="kw">qtm</span>(house_hex) <span class="op">+</span><span class="st"> </span><span class="kw">qtm</span>(wiki_hex)</a></code></pre></div>
<p><img src="explore-wikipedia-location_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Since we need to examine the relation between wiki description and housing prices. It will require to filter out some locations outsdie the hexagons of housing.</p>
</div>
<div id="export-data" class="section level2">
<h2><span class="header-section-number">2.4</span> Export data</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># hex %&gt;% saveRDS(here::here(&quot;project-data/hex.rds&quot;))</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co"># wiki_sf_sg %&gt;% saveRDS(here::here(&quot;project-data/wiki_sf_sg.rds&quot;)) # wiki page with hex id</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co"># </span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co"># house_hex %&gt;% saveRDS(here::here(&quot;project-data/house_hex.rds&quot;))</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co"># wiki_hex %&gt;% saveRDS(here::here(&quot;project-data/wiki_hex.rds&quot;))</span></a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="eda-for-text-contents.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
