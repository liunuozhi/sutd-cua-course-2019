<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 PCA | Explore Wikipedia locations</title>
  <meta name="description" content="Chapter 5 PCA | Explore Wikipedia locations" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 PCA | Explore Wikipedia locations" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 PCA | Explore Wikipedia locations" />
  
  
  

<meta name="author" content="Ronnie Liu Nuozhi" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="topic-modeling.html"/>
<link rel="next" href="conclusion-and-limitations.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Your project name</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Exploring Topics of Place and Housing Price</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#research-question-and-hypothesis"><i class="fa fa-check"></i><b>1.2</b> Research question and hypothesis</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#hypothesis"><i class="fa fa-check"></i><b>1.2.1</b> Hypothesis</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#research-question"><i class="fa fa-check"></i><b>1.2.2</b> Research question</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#data-sources"><i class="fa fa-check"></i><b>1.3</b> Data sources</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#source-1-hdb-housing"><i class="fa fa-check"></i><b>1.3.1</b> Source 1: HDB housing</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#source-2-wikipedia"><i class="fa fa-check"></i><b>1.3.2</b> Source 2: Wikipedia</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#methodology"><i class="fa fa-check"></i><b>1.4</b> Methodology</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#extensionslimitations"><i class="fa fa-check"></i><b>1.5</b> Extensions/Limitations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prepare-data.html"><a href="prepare-data.html"><i class="fa fa-check"></i><b>2</b> Prepare data</a><ul>
<li class="chapter" data-level="2.1" data-path="prepare-data.html"><a href="prepare-data.html#wikipedia-data"><i class="fa fa-check"></i><b>2.1</b> Wikipedia data</a><ul>
<li class="chapter" data-level="2.1.1" data-path="prepare-data.html"><a href="prepare-data.html#change-singapore-to-hexagons"><i class="fa fa-check"></i><b>2.1.1</b> change singapore to hexagons</a></li>
<li class="chapter" data-level="2.1.2" data-path="prepare-data.html"><a href="prepare-data.html#remove-locations-outside-singapore"><i class="fa fa-check"></i><b>2.1.2</b> Remove locations outside Singapore</a></li>
<li class="chapter" data-level="2.1.3" data-path="prepare-data.html"><a href="prepare-data.html#binding-points-with-hex_id"><i class="fa fa-check"></i><b>2.1.3</b> binding points with hex_id</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="prepare-data.html"><a href="prepare-data.html#housing"><i class="fa fa-check"></i><b>2.2</b> Housing</a><ul>
<li class="chapter" data-level="2.2.1" data-path="prepare-data.html"><a href="prepare-data.html#import-housing-location"><i class="fa fa-check"></i><b>2.2.1</b> import housing location</a></li>
<li class="chapter" data-level="2.2.2" data-path="prepare-data.html"><a href="prepare-data.html#binding-housing-to-hexagon"><i class="fa fa-check"></i><b>2.2.2</b> binding housing to hexagon</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="prepare-data.html"><a href="prepare-data.html#wiki-in-conjunction-with-house"><i class="fa fa-check"></i><b>2.3</b> Wiki in conjunction with House</a></li>
<li class="chapter" data-level="2.4" data-path="prepare-data.html"><a href="prepare-data.html#export-data"><i class="fa fa-check"></i><b>2.4</b> Export data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="eda-for-text-contents.html"><a href="eda-for-text-contents.html"><i class="fa fa-check"></i><b>3</b> EDA for text contents</a><ul>
<li class="chapter" data-level="3.1" data-path="eda-for-text-contents.html"><a href="eda-for-text-contents.html#tidy-text"><i class="fa fa-check"></i><b>3.1</b> Tidy text</a><ul>
<li class="chapter" data-level="3.1.1" data-path="eda-for-text-contents.html"><a href="eda-for-text-contents.html#a-look-at-titles"><i class="fa fa-check"></i><b>3.1.1</b> A look at titles</a></li>
<li class="chapter" data-level="3.1.2" data-path="eda-for-text-contents.html"><a href="eda-for-text-contents.html#a-look-at-an-articles"><i class="fa fa-check"></i><b>3.1.2</b> A look at an articles</a></li>
<li class="chapter" data-level="3.1.3" data-path="eda-for-text-contents.html"><a href="eda-for-text-contents.html#tokenizations-lemmatization-pos-tagging"><i class="fa fa-check"></i><b>3.1.3</b> Tokenizations &amp; Lemmatization &amp; POS tagging</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="eda-for-text-contents.html"><a href="eda-for-text-contents.html#n-gram"><i class="fa fa-check"></i><b>3.2</b> N-gram</a><ul>
<li class="chapter" data-level="3.2.1" data-path="eda-for-text-contents.html"><a href="eda-for-text-contents.html#bigram"><i class="fa fa-check"></i><b>3.2.1</b> Bigram</a></li>
<li class="chapter" data-level="3.2.2" data-path="eda-for-text-contents.html"><a href="eda-for-text-contents.html#trigram"><i class="fa fa-check"></i><b>3.2.2</b> Trigram</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="topic-modeling.html"><a href="topic-modeling.html"><i class="fa fa-check"></i><b>4</b> Topic modeling</a><ul>
<li class="chapter" data-level="4.1" data-path="topic-modeling.html"><a href="topic-modeling.html#corpus"><i class="fa fa-check"></i><b>4.1</b> Corpus</a></li>
<li class="chapter" data-level="4.2" data-path="topic-modeling.html"><a href="topic-modeling.html#tf-idf"><i class="fa fa-check"></i><b>4.2</b> TF-IDF</a></li>
<li class="chapter" data-level="4.3" data-path="topic-modeling.html"><a href="topic-modeling.html#lda"><i class="fa fa-check"></i><b>4.3</b> LDA</a><ul>
<li class="chapter" data-level="4.3.1" data-path="topic-modeling.html"><a href="topic-modeling.html#composition-of-topics-theta"><i class="fa fa-check"></i><b>4.3.1</b> Composition of topics (theta)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="topic-modeling.html"><a href="topic-modeling.html#binding-topics-with-spatial-information"><i class="fa fa-check"></i><b>4.4</b> Binding topics with spatial information</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>5</b> PCA</a><ul>
<li class="chapter" data-level="5.1" data-path="pca.html"><a href="pca.html#binding-topic-with-housing"><i class="fa fa-check"></i><b>5.1</b> Binding topic with housing</a></li>
<li class="chapter" data-level="5.2" data-path="pca.html"><a href="pca.html#sample-statistic"><i class="fa fa-check"></i><b>5.2</b> Sample statistic</a><ul>
<li class="chapter" data-level="5.2.1" data-path="pca.html"><a href="pca.html#compare-mean-price-between-topics"><i class="fa fa-check"></i><b>5.2.1</b> Compare mean price between topics</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="pca.html"><a href="pca.html#pca-1"><i class="fa fa-check"></i><b>5.3</b> PCA</a></li>
<li class="chapter" data-level="5.4" data-path="pca.html"><a href="pca.html#regression"><i class="fa fa-check"></i><b>5.4</b> Regression</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="conclusion-and-limitations.html"><a href="conclusion-and-limitations.html"><i class="fa fa-check"></i><b>6</b> Conclusion and limitations</a><ul>
<li class="chapter" data-level="6.1" data-path="conclusion-and-limitations.html"><a href="conclusion-and-limitations.html#conclusion"><i class="fa fa-check"></i><b>6.1</b> Conclusion</a></li>
<li class="chapter" data-level="6.2" data-path="conclusion-and-limitations.html"><a href="conclusion-and-limitations.html#limitations"><i class="fa fa-check"></i><b>6.2</b> Limitations</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Explore Wikipedia locations</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pca" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> PCA</h1>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="kw">theme_light</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">theme_set</span>()</a>
<a class="sourceLine" id="cb78-2" data-line-number="2"></a>
<a class="sourceLine" id="cb78-3" data-line-number="3">house_hex &lt;-<span class="st"> </span><span class="kw">read_rds</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;project-data/house_hex.rds&quot;</span>))</a>
<a class="sourceLine" id="cb78-4" data-line-number="4">theta &lt;-<span class="st"> </span><span class="kw">read_rds</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;project-data/theta.rds&quot;</span>))</a>
<a class="sourceLine" id="cb78-5" data-line-number="5">topic &lt;-<span class="st"> </span><span class="kw">read_rds</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;project-data/topic.rds&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb78-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">topic =</span> <span class="kw">paste</span>(<span class="st">&quot;topic&quot;</span>,topic, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>))</a></code></pre></div>
<div id="binding-topic-with-housing" class="section level2">
<h2><span class="header-section-number">5.1</span> Binding topic with housing</h2>
<p>This setup is to bind topics with housing, which will filter out some locations with topics but without housing informaiton. It opted out the topic 2 (puublic service) which does not appear in the housing datasets.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1">topic &lt;-<span class="st"> </span>topic <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(theta)</a></code></pre></div>
<pre><code>## Joining, by = &quot;document&quot;</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="kw">colnames</span>(topic) &lt;-<span class="st"> </span><span class="kw">paste</span>( <span class="st">&quot;topic&quot;</span>, <span class="kw">colnames</span>(topic), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)</a>
<a class="sourceLine" id="cb81-2" data-line-number="2">house_hex &lt;-<span class="st"> </span>house_hex <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(topic, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;hex_id&quot;</span> =<span class="st"> &quot;topic_document&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb81-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(topic_topic)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="op">!!</span><span class="st">&quot;topic&quot;</span><span class="op">:</span><span class="er">=</span>topic_topic)</a>
<a class="sourceLine" id="cb81-4" data-line-number="4">house_hex <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tm_shape</span>() <span class="op">+</span><span class="st"> </span><span class="kw">tm_polygons</span>(<span class="dt">col =</span> <span class="st">&quot;topic&quot;</span>)</a></code></pre></div>
<p><img src="explore-wikipedia-location_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1">bind_data &lt;-<span class="st"> </span>house_hex <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_set_geometry</span>(<span class="ot">NULL</span>)</a></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1">bind_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</a></code></pre></div>
<pre><code>##   hex_id mean_price mean_area mean_sqr_price mean_lease   topic    topic_1
## 1    167   346765.6 105.20312       3296.153   70.42188 topic_4 0.04075092
## 2    193   365440.9 101.13976       3613.227   75.32289 topic_6 0.24845406
## 3    205   395574.2  88.94545       4447.379   90.05455 topic_7 0.07038835
## 4    206   390642.3 117.43452       3326.469   74.70387 topic_5 0.06833333
## 5    218   455775.8 106.09975       4295.730   82.93682 topic_7 0.03409091
## 6    219   378439.8 107.05645       3534.956   82.97984 topic_5 0.03346995
##      topic_2    topic_3    topic_4    topic_5    topic_6   topic_7    topic_8
## 1 0.07554945 0.02609890 0.57188645 0.07371795 0.10851648 0.0279304 0.07554945
## 2 0.03202297 0.01435512 0.18750000 0.13361307 0.21400177 0.1274293 0.04262367
## 3 0.08980583 0.08980583 0.07038835 0.08009709 0.07038835 0.4684466 0.06067961
## 4 0.06166667 0.06166667 0.05500000 0.42833333 0.06833333 0.1550000 0.10166667
## 5 0.03409091 0.03106061 0.04924242 0.03106061 0.04015152 0.7522727 0.02803030
## 6 0.27937158 0.04166667 0.03346995 0.21926230 0.02800546 0.3203552 0.04439891</code></pre>
</div>
<div id="sample-statistic" class="section level2">
<h2><span class="header-section-number">5.2</span> Sample statistic</h2>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1"><span class="kw">skim</span>(bind_data)</a></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-41">Table 5.1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">bind_data</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">193</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">14</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">12</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">hex_id</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">193</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">topic</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="right">7</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mean_price</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">461830.42</td>
<td align="right">105766.21</td>
<td align="right">260333.33</td>
<td align="right">386485.98</td>
<td align="right">438532.77</td>
<td align="right">523440.25</td>
<td align="right">787926.03</td>
<td align="left">▂▇▃▂▁</td>
</tr>
<tr class="even">
<td align="left">mean_area</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">95.04</td>
<td align="right">14.79</td>
<td align="right">57.00</td>
<td align="right">84.14</td>
<td align="right">95.36</td>
<td align="right">106.00</td>
<td align="right">127.36</td>
<td align="left">▂▅▇▇▃</td>
</tr>
<tr class="odd">
<td align="left">mean_sqr_price</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4916.61</td>
<td align="right">1114.77</td>
<td align="right">3296.15</td>
<td align="right">4043.05</td>
<td align="right">4589.79</td>
<td align="right">5482.73</td>
<td align="right">8770.76</td>
<td align="left">▇▇▃▂▁</td>
</tr>
<tr class="even">
<td align="left">mean_lease</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">70.80</td>
<td align="right">9.05</td>
<td align="right">50.22</td>
<td align="right">64.38</td>
<td align="right">69.22</td>
<td align="right">77.27</td>
<td align="right">95.36</td>
<td align="left">▂▇▆▅▁</td>
</tr>
<tr class="odd">
<td align="left">topic_1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.07</td>
<td align="right">0.07</td>
<td align="right">0.01</td>
<td align="right">0.03</td>
<td align="right">0.05</td>
<td align="right">0.08</td>
<td align="right">0.51</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">topic_2</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.08</td>
<td align="right">0.13</td>
<td align="right">0.01</td>
<td align="right">0.03</td>
<td align="right">0.04</td>
<td align="right">0.08</td>
<td align="right">0.81</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">topic_3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.07</td>
<td align="right">0.11</td>
<td align="right">0.00</td>
<td align="right">0.02</td>
<td align="right">0.04</td>
<td align="right">0.07</td>
<td align="right">0.63</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">topic_4</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.08</td>
<td align="right">0.11</td>
<td align="right">0.01</td>
<td align="right">0.03</td>
<td align="right">0.05</td>
<td align="right">0.09</td>
<td align="right">0.75</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">topic_5</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.24</td>
<td align="right">0.28</td>
<td align="right">0.00</td>
<td align="right">0.03</td>
<td align="right">0.08</td>
<td align="right">0.48</td>
<td align="right">0.89</td>
<td align="left">▇▁▁▂▁</td>
</tr>
<tr class="even">
<td align="left">topic_6</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.08</td>
<td align="right">0.09</td>
<td align="right">0.01</td>
<td align="right">0.03</td>
<td align="right">0.05</td>
<td align="right">0.09</td>
<td align="right">0.73</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">topic_7</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.24</td>
<td align="right">0.24</td>
<td align="right">0.00</td>
<td align="right">0.05</td>
<td align="right">0.14</td>
<td align="right">0.39</td>
<td align="right">0.88</td>
<td align="left">▇▂▂▁▁</td>
</tr>
<tr class="even">
<td align="left">topic_8</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.13</td>
<td align="right">0.16</td>
<td align="right">0.01</td>
<td align="right">0.04</td>
<td align="right">0.07</td>
<td align="right">0.15</td>
<td align="right">0.75</td>
<td align="left">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1">bind_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb86-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="kw">fct_reorder</span>(topic, mean_sqr_price), mean_sqr_price)) <span class="op">+</span></a>
<a class="sourceLine" id="cb86-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="explore-wikipedia-location_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>The chart and statistics summary above show that there some price-topic relation. Topic 4 (university) shows higher average housing prices. Topic 6 (important buildings) has second highest average housing price. While the housing near topic 8 (culture) has the least housing price.</p>
<div id="compare-mean-price-between-topics" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Compare mean price between topics</h3>
<p>The hypothesis testing takes topic 5 (School) and topic 6 (Important buildings) as comparison. The null hypothesis assumes that the topics have a same housing price, which is <code>mean(topic5) - mean(topic6) = 0</code>.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1">topic_mean &lt;-<span class="st"> </span>bind_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb87-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(topic <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;topic_5&quot;</span>, <span class="st">&quot;topic_6&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb87-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(topic) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb87-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(mean_sqr_price))</a>
<a class="sourceLine" id="cb87-5" data-line-number="5">topic_mean</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   topic    mean
##   &lt;chr&gt;   &lt;dbl&gt;
## 1 topic_5 4791.
## 2 topic_6 5378.</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb89-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_histogram</span>(</a>
<a class="sourceLine" id="cb89-3" data-line-number="3">    <span class="dt">data =</span> bind_data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb89-4" data-line-number="4"><span class="st">      </span><span class="kw">filter</span>(topic <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;topic_5&quot;</span>, <span class="st">&quot;topic_6&quot;</span>)),</a>
<a class="sourceLine" id="cb89-5" data-line-number="5">    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mean_sqr_price, <span class="dt">group =</span> topic, <span class="dt">fill =</span> topic),</a>
<a class="sourceLine" id="cb89-6" data-line-number="6">    <span class="dt">position =</span> <span class="kw">position_dodge</span>()</a>
<a class="sourceLine" id="cb89-7" data-line-number="7">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb89-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_vline</span>(</a>
<a class="sourceLine" id="cb89-9" data-line-number="9">    <span class="dt">data =</span> topic_mean,</a>
<a class="sourceLine" id="cb89-10" data-line-number="10">    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">xintercept =</span> mean, <span class="dt">group =</span> topic, <span class="dt">color =</span> topic)</a>
<a class="sourceLine" id="cb89-11" data-line-number="11">  )</a></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="explore-wikipedia-location_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1">bind_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb91-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(topic <span class="op">==</span><span class="st"> &quot;topic_5&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb91-3" data-line-number="3"><span class="st">  </span><span class="kw">specify</span>(<span class="dt">response =</span> mean_sqr_price) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb91-4" data-line-number="4"><span class="st">  </span><span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb91-5" data-line-number="5"><span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;mean&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb91-6" data-line-number="6"><span class="st">  </span><span class="kw">get_ci</span>()</a></code></pre></div>
<pre><code>## Setting `type = &quot;bootstrap&quot;` in `generate()`.</code></pre>
<pre><code>## # A tibble: 1 x 2
##   `2.5%` `97.5%`
##    &lt;dbl&gt;   &lt;dbl&gt;
## 1  4598.   5070.</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1">mean_diff &lt;-<span class="st"> </span>bind_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb94-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(topic <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;topic_5&quot;</span>, <span class="st">&quot;topic_6&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb94-3" data-line-number="3"><span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> mean_sqr_price <span class="op">~</span><span class="st"> </span>topic) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb94-4" data-line-number="4"><span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;diff in means&quot;</span>, <span class="dt">order =</span> <span class="kw">c</span>(<span class="st">&quot;topic_5&quot;</span>, <span class="st">&quot;topic_6&quot;</span>))</a>
<a class="sourceLine" id="cb94-5" data-line-number="5">mean_diff</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##    stat
##   &lt;dbl&gt;
## 1 -587.</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1">null_distribution &lt;-<span class="st"> </span>bind_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb96-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(topic <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;topic_5&quot;</span>, <span class="st">&quot;topic_6&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb96-3" data-line-number="3"><span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> mean_sqr_price <span class="op">~</span><span class="st"> </span>topic) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb96-4" data-line-number="4"><span class="st">  </span><span class="kw">hypothesize</span>(<span class="dt">null =</span> <span class="st">&quot;independence&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb96-5" data-line-number="5"><span class="st">  </span><span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">500</span>, <span class="dt">type =</span> <span class="st">&quot;permute&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb96-6" data-line-number="6"><span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;diff in means&quot;</span>, <span class="dt">order =</span> <span class="kw">c</span>(<span class="st">&quot;topic_5&quot;</span>, <span class="st">&quot;topic_6&quot;</span>))</a>
<a class="sourceLine" id="cb96-7" data-line-number="7"></a>
<a class="sourceLine" id="cb96-8" data-line-number="8">null_ci &lt;-<span class="st"> </span>null_distribution <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">get_ci</span>()</a>
<a class="sourceLine" id="cb96-9" data-line-number="9"></a>
<a class="sourceLine" id="cb96-10" data-line-number="10">null_distribution <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb96-11" data-line-number="11"><span class="st">  </span><span class="kw">visualise</span>(<span class="dt">bins =</span> <span class="dv">100</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb96-12" data-line-number="12"><span class="st">  </span><span class="kw">shade_p_value</span>(<span class="dt">obs_stat =</span> mean_diff, <span class="dt">direction =</span> <span class="st">&quot;both&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb96-13" data-line-number="13"><span class="st">  </span><span class="kw">shade_ci</span>(null_ci)</a></code></pre></div>
<p><img src="explore-wikipedia-location_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1">null_distribution <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb97-2" data-line-number="2"><span class="st">  </span><span class="kw">get_pvalue</span>(<span class="dt">obs_stat =</span> mean_diff, <span class="dt">direction =</span> <span class="st">&quot;both&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   p_value
##     &lt;dbl&gt;
## 1       0</code></pre>
<p>The significance is set to 0.05. In this case, the p-value is smaller than 0.05. So, it rejects <code>H0</code>, and indicates that the average price of topic 5 is significantly different from that of topic 6.</p>
</div>
</div>
<div id="pca-1" class="section level2">
<h2><span class="header-section-number">5.3</span> PCA</h2>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1">topic_house &lt;-<span class="st"> </span>bind_data</a>
<a class="sourceLine" id="cb99-2" data-line-number="2">topic_house <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;topic_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</a></code></pre></div>
<pre><code>##      topic_1    topic_2    topic_3    topic_4    topic_5    topic_6   topic_7
## 1 0.04075092 0.07554945 0.02609890 0.57188645 0.07371795 0.10851648 0.0279304
## 2 0.24845406 0.03202297 0.01435512 0.18750000 0.13361307 0.21400177 0.1274293
## 3 0.07038835 0.08980583 0.08980583 0.07038835 0.08009709 0.07038835 0.4684466
## 4 0.06833333 0.06166667 0.06166667 0.05500000 0.42833333 0.06833333 0.1550000
## 5 0.03409091 0.03409091 0.03106061 0.04924242 0.03106061 0.04015152 0.7522727
## 6 0.03346995 0.27937158 0.04166667 0.03346995 0.21926230 0.02800546 0.3203552
##      topic_8
## 1 0.07554945
## 2 0.04262367
## 3 0.06067961
## 4 0.10166667
## 5 0.02803030
## 6 0.04439891</code></pre>
<p>To understand more about the dataset, it will use PCA to see how the topics incorporate with each other. The input data with be the theta value of each hexagons (shows above output). The theta value indicates how the data fit with each topics and shows the probabilities.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1">pc &lt;-<span class="st"> </span>topic_house <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-2" data-line-number="2"><span class="st">  </span><span class="co"># select(-mean_price, -mean_area, -topic) %&gt;% </span></a>
<a class="sourceLine" id="cb101-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;topic_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-4" data-line-number="4"><span class="st">  </span><span class="kw">prcomp</span>(., <span class="dt">scale. =</span> T, <span class="dt">center =</span> T)</a>
<a class="sourceLine" id="cb101-5" data-line-number="5"></a>
<a class="sourceLine" id="cb101-6" data-line-number="6"><span class="kw">tidy</span>(pc, <span class="st">&quot;pcs&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 8 x 4
##      PC  std.dev percent cumulative
##   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;
## 1     1 1.32e+ 0   0.216      0.216
## 2     2 1.18e+ 0   0.175      0.391
## 3     3 1.05e+ 0   0.138      0.529
## 4     4 1.01e+ 0   0.128      0.657
## 5     5 9.91e- 1   0.123      0.780
## 6     6 9.64e- 1   0.116      0.896
## 7     7 9.12e- 1   0.104      1    
## 8     8 5.25e-16   0          1</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" data-line-number="1"><span class="kw">tidy</span>(pc, <span class="st">&quot;pcs&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb103-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PC, <span class="dt">y =</span> percent)) <span class="op">+</span></a>
<a class="sourceLine" id="cb103-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb103-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PC, <span class="dt">y =</span> percent, <span class="dt">label =</span> PC), <span class="dt">nudge_y =</span> <span class="fl">0.03</span>)</a></code></pre></div>
<p><img src="explore-wikipedia-location_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="kw">tidy</span>(pc, <span class="st">&quot;pcs&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb104-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PC, <span class="dt">y =</span> cumulative)) <span class="op">+</span></a>
<a class="sourceLine" id="cb104-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">0.8</span>, <span class="dt">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb104-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb104-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PC, <span class="dt">y =</span> cumulative, <span class="dt">label =</span> PC), <span class="dt">nudge_y =</span> <span class="fl">0.03</span>)</a></code></pre></div>
<p><img src="explore-wikipedia-location_files/figure-html/unnamed-chunk-49-2.png" width="672" /></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" data-line-number="1"><span class="kw">tidy</span>(pc, <span class="st">&quot;variables&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb105-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(PC <span class="op">&lt;</span><span class="st"> </span><span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># only show first 4 components</span></a>
<a class="sourceLine" id="cb105-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> column, <span class="dt">y =</span> value)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb105-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb105-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>(value <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>)),</a>
<a class="sourceLine" id="cb105-6" data-line-number="6">           <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb105-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb105-8" data-line-number="8"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span>PC)</a></code></pre></div>
<p><img src="explore-wikipedia-location_files/figure-html/unnamed-chunk-49-3.png" width="672" /></p>
<p>In order to catch 80% of variance, it will set to see the first 5 princle components. Even thought the dimension do not reduce a lot, it provides a scope to see how the topics related. From the first component, the topic 4 (university) and 5 (schools) have negative relations with other topics. With some nuance, topic 7 will be less likely to align with others, which shows in PC2.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1"><span class="kw">autoplot</span>(pc, <span class="dt">label =</span> <span class="ot">TRUE</span>, <span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">loadings =</span> T, <span class="dt">loadings.label =</span> T, <span class="dt">label.size =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="explore-wikipedia-location_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" data-line-number="1"><span class="kw">autoplot</span>(pc, <span class="dt">label =</span> <span class="ot">TRUE</span>, <span class="dt">x =</span> <span class="dv">3</span>, <span class="dt">y =</span> <span class="dv">4</span>, <span class="dt">loadings =</span> T, <span class="dt">loadings.label =</span> T, <span class="dt">label.size =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="explore-wikipedia-location_files/figure-html/unnamed-chunk-50-2.png" width="672" /></p>
<p>From PC1 and PC2 dimension, most topics are close to each other except topic 4, 5, 7. It shows that topic 4 (university) and topic 7 (transport) have negative relations. Topic 5 (schools) also shows relatively negative relation with topic 7.</p>
<p>From PC3 and PC4, it shows that topic 4 (university) shows either negative or no relation with other topics. A possible reason may be a university can be a isolated area with self functioning place like a university town. The same feature also appear to topic 7 (transport), because the transportation interchange may take a large area land where other functional places may not be able to be included.</p>
<p>Topic 1 (landmark), 3 (recreation), 5 (school) and 8 (culture) show a strong relation with each other, the reason may be that Singapore has well mixture of land use.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1">pc_topic &lt;-<span class="st"> </span>topic_house <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb108-2" data-line-number="2"><span class="st">  </span><span class="kw">augment</span>(pc, .) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb108-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(hex_id, mean_sqr_price, .fittedPC1, .fittedPC2, .fittedPC3, .fittedPC4, .fittedPC5)</a>
<a class="sourceLine" id="cb108-4" data-line-number="4">pc_topic <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</a></code></pre></div>
<pre><code>## # A tibble: 6 x 7
##   hex_id mean_sqr_price .fittedPC1 .fittedPC2 .fittedPC3 .fittedPC4 .fittedPC5
##   &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
## 1 167             3296.     -0.527      1.83     -2.46       2.37     -2.30   
## 2 193             3613.      0.944      0.775    -0.0504     1.76     -0.934  
## 3 205             4447.      0.448     -1.02     -0.298      0.0708   -0.170  
## 4 206             3326.     -0.649      0.165     0.436     -0.200    -0.00827
## 5 218             4296.      0.205     -2.35     -0.438      0.465     0.235  
## 6 219             3535.     -0.288     -0.504    -1.21      -1.24      0.399</code></pre>
</div>
<div id="regression" class="section level2">
<h2><span class="header-section-number">5.4</span> Regression</h2>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1">ols &lt;-<span class="st"> </span><span class="kw">lm</span>(mean_sqr_price <span class="op">~</span><span class="st"> </span>.fittedPC1<span class="op">+</span><span class="st"> </span>.fittedPC2<span class="op">+</span><span class="st"> </span>.fittedPC3<span class="op">+</span><span class="st"> </span>.fittedPC4<span class="op">+</span><span class="st"> </span>.fittedPC5, pc_topic)</a>
<a class="sourceLine" id="cb110-2" data-line-number="2"><span class="kw">glance</span>(ols)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 11
##   r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0.148         0.126 1042.      6.52 1.30e-5     6 -1612. 3238. 3261.
## # … with 2 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;</code></pre>
<p>The regression model take on the first 5 principle components which consisting of theta values. The R.squared shows a relative low relation between housing price and topics.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1"><span class="kw">tidy</span>(ols)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)  4917.        75.0   65.5    6.19e-131
## 2 .fittedPC1    161.        57.2    2.81   5.42e-  3
## 3 .fittedPC2    278.        63.7    4.36   2.11e-  5
## 4 .fittedPC3      1.57      71.6    0.0220 9.82e-  1
## 5 .fittedPC4    126.        74.4    1.69   9.27e-  2
## 6 .fittedPC5    126.        75.9    1.66   9.77e-  2</code></pre>
<p>A potential interpretation of the regression model may be that the PC1 and PC2 will have higher estimated housing prices, which the divergence of schols/university/transport and other locations being cateched. This divergence intensify the housing price fluctuation. In other words, if the locations tend to be either educational area or others, the housing prices may show a relative increase or decrease.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" data-line-number="1">topic_house_ols &lt;-<span class="st"> </span><span class="kw">augment</span>(ols, <span class="dt">data =</span> topic_house)</a>
<a class="sourceLine" id="cb114-2" data-line-number="2">topic_house_ols</a></code></pre></div>
<pre><code>## # A tibble: 193 x 21
##    hex_id mean_price mean_area mean_sqr_price mean_lease topic topic_1 topic_2
##    &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 167       346766.     105.           3296.       70.4 topi… 0.0408   0.0755
##  2 193       365441.     101.           3613.       75.3 topi… 0.248    0.0320
##  3 205       395574.      88.9          4447.       90.1 topi… 0.0704   0.0898
##  4 206       390642.     117.           3326.       74.7 topi… 0.0683   0.0617
##  5 218       455776.     106.           4296.       82.9 topi… 0.0341   0.0341
##  6 219       378440.     107.           3535.       83.0 topi… 0.0335   0.279 
##  7 246       495319.     109.           4529.       80.6 topi… 0.00719  0.0119
##  8 261       295190.      73.5          4018.       61.9 topi… 0.045    0.025 
##  9 277       403684.     115.           3505.       66.8 topi… 0.108    0.125 
## 10 290       374949.     101.           3729.       70.8 topi… 0.336    0.152 
## # … with 183 more rows, and 13 more variables: topic_3 &lt;dbl&gt;, topic_4 &lt;dbl&gt;,
## #   topic_5 &lt;dbl&gt;, topic_6 &lt;dbl&gt;, topic_7 &lt;dbl&gt;, topic_8 &lt;dbl&gt;, .fitted &lt;dbl&gt;,
## #   .se.fit &lt;dbl&gt;, .resid &lt;dbl&gt;, .hat &lt;dbl&gt;, .sigma &lt;dbl&gt;, .cooksd &lt;dbl&gt;,
## #   .std.resid &lt;dbl&gt;</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="topic-modeling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusion-and-limitations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
